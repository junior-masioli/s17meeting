function load_partial_poll_votes(){var t=jQuery(".poll-result .poll-id").attr("data-id");jQuery.ajax({url:Drupal.url("admin/meeting/poll/"+t+"/result/votes"),type:"GET",contentType:"application/json",dataType:"text",success:function(t){var e="";const a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];jQuery.map(JSON.parse(t).data,function(t,o){e+=resultMarkup(t,a[o])}),jQuery("#poll_results").html(e||"<li class='no-results'>No results</li>")}})}function resultMarkup(t,e){var a="",o=0!=t.total_votes?parseInt(t.votes)/parseInt(t.total_votes)*100:0;return a+="<li>",a+='<div class="poll-result-content__label">',a+="<span><strong>"+e+".</strong> "+t.answer+"</span>",a+="<span>"+o+"%</span>",a+="</div>",a+='<div class="poll-result-content__bar" style="background-color:'+jQuery(".meeting-shadow-colour").attr("data-colour")+';">',a+='<span style="width: '+o+"%; background-color:"+jQuery(".meeting-bar-colour").attr("data-colour")+';"></span>',a+="</div>",a+="</li>"}function emitData(t,e,a){const o={room:t,username:e,message:a};socket.emit("sidebar",o)}function refreshQuestionDataTable(){var t=jQuery("input[data-drupal-selector='edit-id']").val();jQuery.ajax({url:Drupal.url("admin/meeting/question/"+t+"/true/list"),type:"GET",contentType:"application/json",dataType:"text",success:function(t){jQuery("#display_question").html(t)}})}function refreshAdminQuestions(){var t=jQuery("input[data-drupal-selector='edit-uuid']").val();socket=io("https://s-17-websocket-x682q.ondigitalocean.app");var e="Room_"+t,a="Username_"+t;socket.emit("select_room",{username:a,room:e},t=>{t.forEach(t=>createMessage(t))}),socket.on("question",function(t){let{text:e}=t;"question"==e&&refreshQuestionDataTable()})}function load_partial_question(){var t=jQuery(".question-meeting-uuid").attr("data-uuid");jQuery.ajax({url:Drupal.url("admin/meeting/"+t+"/questions/moderator/json"),type:"GET",contentType:"application/json",dataType:"text",success:function(t){var e="",a="",o="";jQuery.map(JSON.parse(t).data,function(t){0==t.status&&(e+=questionMarkup(t)),1==t.status&&(a+=questionMarkup(t)),2==t.status&&(o+=questionMarkup(t))}),jQuery("#question_new").html(e||"<li class='no-results'>No results</li>"),jQuery("#question_approved ").html(a||"<li class='no-results'>No results</li>"),jQuery("#question_archived").html(o||"<li class='no-results'>No results</li>")}})}function questionMarkup(t){var e="",a=0==t.status&&"contenteditable",o=t.status<2?"column":"full",n=t.status>0?"border-bottom-1":"",s=t.status>0?"border-0":"";return e+="<li class='"+n+" "+o+"'>",e+="<div class='col-left'>",e+="<p data-id="+t.id+" class='textarea "+s+"' role='textbox' "+a+" id='question_"+t.id+"'>"+t.question+"</p>",0==t.status&&(e+="<div class='actions' id='actions_"+t.id+"'>",e+="<button data-id='"+t.id+"' class='btn-moderate cancel' disabled>Cancel</button>",e+="<button data-id='"+t.id+"' class='btn-moderate save' disabled>Save</button>",e+="</div>"),e+="</div>",t.status<2&&(e+="<div class='col-right'>",t.status<1&&(e+="<button data-status='1' data-id='"+t.id+"' class='btn-moderate up-status approve'>Approve</button>"),e+="<button data-status='2' data-id='"+t.id+"' class='btn-moderate up-status archive'>Archive</button>",e+="</div>"),e+="</li>"}function refreshModerateQuestions(){socket=io("https://s-17-websocket-x682q.ondigitalocean.app");var t=jQuery(".question-meeting-uuid").attr("data-uuid"),e="Room_"+t,a="Username_"+t;socket.emit("select_room",{username:a,room:e},t=>{t.forEach(t=>createMessage(t))}),socket.on("question",function(t){let{text:e}=t;"question"==e&&load_partial_question()})}function emitSpeakerQuestion(){var t=jQuery(".question-meeting-uuid").attr("data-uuid");const e={room:"Room_"+t,username:"Username_"+t,message:"question"};socket.emit("question",e)}!function(t,e){"use strict";t(document).on("click",".answer-edit-ajax",function(e){var a=JSON.parse(t(this).attr("data-answer"));t("input[data-drupal-selector='edit-answer']").val(a.answer),t("input[data-selector-id='poll-answer-id']").val(a.id),e.preventDefault()}),t(document).on("click",".remove-answer-ajax",function(e){var a=this,o=JSON.parse(t(this).attr("data-answer"));t.ajax({url:t(this).attr("data-answer-url"),data:{id:o.id},type:"POST",dataType:"JSON",success:function(e){t(".poll-answer-form")[0].reset(),t("input[data-selector-id='poll-answer-id']").val(""),t(a).closest("tr").remove()},error:function(t){}}),e.preventDefault()})}(jQuery,Drupal),function(t,e){e.behaviors.meeting={attach:function(e,a){socket=io("https://s-17-websocket-x682q.ondigitalocean.app");var o,n=document.getElementsByClassName("closebtn");for(o=0;o<n.length;o++)n[o].onclick=function(){var t=this.parentElement;t.style.opacity="0",t.style.display="none"};t(".component-color",e).once("click-color").click(function(){t(this).find("input",e).once("click-color").click(),t(e).find(".component-color",e).find("input").removeOnce("click-color")})}},t(document).on("click",".module-activate-ajax",function(e){var a=t(this).attr("data-id").split("|");t.ajax({url:t(this).attr("data-url"),type:"post",data:{meeting_id:a[0],module:a[1],order:a[2]},dataType:"JSON",success:function(t){},error:function(t){}})}),t(document).ready(function(){t(".action_ajax").click(function(t){t.preventDefault()})}),e.behaviors.AjaxLinkChange={attach:function(a){t(".turbolink",a).once().bind("click",function(a){a.preventDefault();var o={url:t(this).attr("href"),element:this};t(this).closest("tr").remove(),e.ajax(o).execute()})}},e.AjaxCommands.prototype.RemoveTr=function(t,e,a){},e.AjaxCommands.prototype.load_partial=function(a,o,n){var s=o.div;t.ajax({url:o.url,type:"GET",contentType:"application/json",dataType:"text",success:function(a){t(s).html(a),e.settings=a[0].settings,e.attachBehaviors(t(s)[0],e.settings)}}),o.form&&t(o.form)[0].reset()}}(jQuery,Drupal),function(t,e){t(document).on("click",".edit-poll-ajax",function(e){var a=JSON.parse(t(this).attr("data-poll"));t("input[data-drupal-selector='edit-poll-question']").val(a.poll_question),t("input[data-selector-id='poll-id']").val(a.id),e.preventDefault()}),t(document).on("click",".remove-poll",function(e){var a=this;t.ajax({url:t(this).attr("data-url"),type:"get",contentType:"application/json",dataType:"text",success:function(e){document.getElementById("poll-form").reset(),t("input[data-selector-id='poll-id']").val(""),t(a).closest("tr").remove()},error:function(t){}}),e.preventDefault()}),t(document).on("click",".poll-control-ajax",function(e){var a=this,o=t(this).attr("data-uuid");t.ajax({url:t(this).attr("data-url"),type:"post",data:{id:t(this).attr("data-id")},dataType:"JSON",success:function(e){if(1===e.data?emitData("Room_"+o,"Username_"+o,"RefreshPoll"):emitData("Room_"+o,"Username_"+o,"RemovePoll"),"No"===t(a).text())return t(a).text("Yes"),t(a).removeClass("btn--danger"),t(a).addClass("btn--success"),!1;t(a).text("No"),t(a).removeClass("btn--success"),t(a).addClass("btn--danger")},error:function(t){}})}),t(document).on("click",".action-dropdown",function(e){t(".dropdown-active").find(".action-item-dropdown").stop().slideUp(400),t(".action-dropdown").removeClass("dropdown-active"),t(this).find(".action-item-dropdown").stop().slideDown(400),t(this).addClass("dropdown-active"),e.preventDefault()}),t(document).on("mouseleave",".action-dropdown",function(e){t(".dropdown-active").find(".action-item-dropdown").stop().slideUp(400),t(".action-dropdown").removeClass("dropdown-active"),e.preventDefault()}),load_partial_poll_votes()}(jQuery,Drupal),function(t,e){"use strict";t(document).on("click",".update-question-ajax",function(e){var a=this,o=JSON.parse(t(this).attr("data-id")),n=JSON.parse(t(this).attr("data-status"));t.ajax({url:t(this).attr("data-url"),data:{id:o,status:n},type:"POST",dataType:"JSON",success:function(e){t(a).closest("tr").find(".update-question-ajax").attr("data-url",""),t(a).closest("tr").find(".update-question-ajax").removeClass("btn--primary"),t(a).closest("tr").find(".update-question-ajax").removeClass("update-question-ajax")},error:function(t){}}),e.preventDefault()}),t(document).on("click",".delete-question-ajax",function(e){var a=this,o=JSON.parse(t(this).attr("data-id")),n=JSON.parse(t(this).attr("data-status"));t.ajax({url:t(this).attr("data-url"),data:{id:o,status:n},type:"POST",dataType:"JSON",success:function(e){t(a).closest("tr").remove()},error:function(t){}}),e.preventDefault()}),refreshAdminQuestions()}(jQuery,Drupal),function(t,e){"use strict";function a(a,o){t.ajax({url:e.url(a),data:o,type:"POST",dataType:"JSON",success:function(t){console.log(t.message)},error:function(t){console.log(t)}})}t(document).on("click",".col-question .textarea",function(e){var a=JSON.parse(t(this).attr("data-id"));t("#actions_"+a+" button").attr("disabled",!1)}),t(document).on("mousedown",".col-question .textarea",function(e){var a=JSON.parse(t(this).attr("data-id"));t("#actions_"+a+" button").attr("disabled",!1)}),t(document).on("click",".col-question .cancel",function(e){var a=JSON.parse(t(this).attr("data-id"));t("#actions_"+a+" button").attr("disabled",!0),load_partial_question(),e.preventDefault()}),t(document).on("click",".col-question .save",function(e){var o=JSON.parse(t(this).attr("data-id"));a("admin/meeting/moderator/question/update",{id:o,question:t("#question_"+o).html()}),setTimeout(function(){emitSpeakerQuestion()},200),e.preventDefault()}),t(document).on("click",".col-question .up-status",function(e){a("admin/meeting/moderator/question/update",{id:JSON.parse(t(this).attr("data-id")),status:JSON.parse(t(this).attr("data-status"))}),setTimeout(function(){emitSpeakerQuestion()},200),e.preventDefault()}),t(document).ready(function(){load_partial_question()}),refreshModerateQuestions()}(jQuery,Drupal);